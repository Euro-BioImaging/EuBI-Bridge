<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>CLI Usage - EuBI-Bridge</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
        <link href="../css/custom.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "CLI Usage";
        var mkdocs_page_input_path = "__cli.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> EuBI-Bridge
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../cli/">CLI Usage</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../conversion_tutorial/">Conversion Tutorial</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">EuBI-Bridge</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">CLI Usage</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/Euro-BioImaging/EuBI-Bridge/edit/master/docs/__cli.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="cli-usage">CLI Usage</h1>
<p>After the installation of EuBI-Bridge, the CLI command <code>eubi</code> is available globally.</p>
<h2 id="quick-start">Quick start</h2>
<p><strong>Examples: unary conversion</strong></p>
<p>Convert each file in the <code>input_dir</code> to an OME-Zarr container and saves it in the <code>output_dir</code>:</p>
<pre><code class="language-bash">eubi to_zarr /path/to/input_dir /path/to/output_dir
</code></pre>
<p>Convert all files excluding those with <code>thumbs</code> in the filename:</p>
<pre><code class="language-bash">eubi to_zarr /path/to/input_dir /path/to/output_dir --excludes 'thumbs'
</code></pre>
<p>Convert exclusively the <code>tiff</code> files from the input directory using wildcards:</p>
<pre><code class="language-bash">eubi to_zarr &quot;/path/to/input_dir/*tiff&quot; /path/to/output_dir
</code></pre>
<hr />
<hr />
<h2 id="main-commands">Main commands</h2>
<h3 id="eubito_zarr"><code>eubi::to_zarr</code></h3>
<p>The conversion command <code>eubi to_zarr</code> supports <strong>unary</strong> and <strong>aggregative</strong> conversion with optional filtering, downscaling and metadata specification.</p>
<p>The parameters described in the tables below can be directly supplied to the command <code>eubi to_zarr</code>. </p>
<h4 id="non-configurable-parameters">Non-configurable parameters</h4>
<p>These parameters have static defaults and cannot be configured, i.e., their values cannot be modified in the configuration file. In order to use a different value for any of these parameters, supply that value directly in the conversion command (see <a href="#examples">examples</a>).</p>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>input_path</code></td>
<td><code>str</code> or <code>Path</code> (mandatory)</td>
<td>Path to input file or folder</td>
</tr>
<tr>
<td><code>output_path</code></td>
<td><code>str</code> or <code>Path</code> (mandatory)</td>
<td>Path to output Zarr directory</td>
</tr>
<tr>
<td><code>--includes</code></td>
<td><code>str</code></td>
<td>Include filter for filenames</td>
</tr>
<tr>
<td><code>--excludes</code></td>
<td><code>str</code></td>
<td>Exclude filter for filenames</td>
</tr>
<tr>
<td><code>--series</code></td>
<td><code>int</code></td>
<td>BioFormats series index</td>
</tr>
<tr>
<td><code>--time_tag</code></td>
<td><code>str</code> or <code>tuple</code></td>
<td>Time axis tag</td>
</tr>
<tr>
<td><code>--channel_tag</code></td>
<td><code>str</code> or <code>tuple</code></td>
<td>Channel axis tag</td>
</tr>
<tr>
<td><code>--z_tag</code></td>
<td><code>str</code> or <code>tuple</code></td>
<td>Z-dimension tag</td>
</tr>
<tr>
<td><code>--y_tag</code></td>
<td><code>str</code> or <code>tuple</code></td>
<td>Y-dimension tag</td>
</tr>
<tr>
<td><code>--x_tag</code></td>
<td><code>str</code> or <code>tuple</code></td>
<td>X-dimension tag</td>
</tr>
<tr>
<td><code>--concatenation_axes</code></td>
<td><code>int</code>, <code>tuple</code>, or <code>str</code></td>
<td>Axes for concatenating datasets</td>
</tr>
<tr>
<td><code>--time_scale</code></td>
<td><code>int</code>, <code>float</code></td>
<td>Temporal increment</td>
</tr>
<tr>
<td><code>--z_scale</code></td>
<td><code>int</code>, <code>float</code></td>
<td>Z spatial increment</td>
</tr>
<tr>
<td><code>--y_scale</code></td>
<td><code>int</code>, <code>float</code></td>
<td>Y spatial increment</td>
</tr>
<tr>
<td><code>--x_scale</code></td>
<td><code>int</code>, <code>float</code></td>
<td>X spatial increment</td>
</tr>
<tr>
<td><code>--time_unit</code></td>
<td><code>str</code></td>
<td>Temporal unit</td>
</tr>
<tr>
<td><code>--z_unit</code></td>
<td><code>str</code></td>
<td>Z spatial unit</td>
</tr>
<tr>
<td><code>--y_unit</code></td>
<td><code>str</code></td>
<td>Y spatial unit</td>
</tr>
<tr>
<td><code>--x_unit</code></td>
<td><code>str</code></td>
<td>X spatial unit</td>
</tr>
</tbody>
</table>
<h5 id="examples">Examples</h5>
<p><em>Unary conversion</em></p>
<p>Convert each file in the <code>input_dir</code> while overriding specific pixel metadata:</p>
<pre><code class="language-bash">eubi to_zarr /path/to/input_dir /path/to/output_dir --z_scale 2.5 --z_unit micrometer --time_scale 1.5 --time_unit second
</code></pre>
<p>This command overrides the z scaling metadata from the input files with the user-specified values.</p>
<p><em>Aggregative conversion</em></p>
<p>To perform aggregative conversion, one has to specify certain command line arguments to the <code>to_zarr</code> command: </p>
<pre><code class="language-bash">eubi to_zarr /path/to/input_dir /path/to/output_dir --z_tag slice_ --concatenation_axes z
</code></pre>
<p>This command will identify the indices of the z axis based on the pattern 'slice_' in the file paths (as specified with <code>--z_tag</code>) and concatenate the files along the z axis (as specified with the <code>--concatenation_axes</code>).</p>
<h4 id="configurable-parameters">Configurable parameters</h4>
<p>The parameters below can also be supplied to the command <code>to_zarr</code> similarly to the examples above. However, they can also be simply updated in the configuration file to avoid repetitively typing them for each conversion. See the configuration section for more details.</p>
<h5 id="cluster-parameters">Cluster parameters</h5>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--memory_limit</code></td>
<td><code>str</code></td>
<td>Maximum memory limit per Dask worker.</td>
</tr>
<tr>
<td><code>--n_jobs</code></td>
<td><code>int</code></td>
<td>Number of Dask workers to launch.</td>
</tr>
<tr>
<td><code>--no_distributed</code></td>
<td><code>bool</code></td>
<td>If <code>True</code>, disables distributed computation.</td>
</tr>
<tr>
<td><code>--no_worker_restart</code></td>
<td><code>bool</code></td>
<td>If <code>True</code>, prevents restarting workers on failure.</td>
</tr>
<tr>
<td><code>--on_slurm</code></td>
<td><code>bool</code></td>
<td>If <code>True</code>, executes computation on SLURM.</td>
</tr>
<tr>
<td><code>--temp_dir</code></td>
<td><code>str</code></td>
<td>Temporary directory for Dask workers.</td>
</tr>
<tr>
<td><code>--threads_per_worker</code></td>
<td><code>int</code></td>
<td>Number of threads per Dask worker.</td>
</tr>
<tr>
<td><code>--verbose</code></td>
<td><code>bool</code></td>
<td>Enables verbose logging.</td>
</tr>
</tbody>
</table>
<h5 id="conversion-parameters">Conversion parameters</h5>
<table>
  <thead>
    <tr>
      <th style="width: 280px; text-align: left;">Parameter</th>
      <th style="width: 100px;">Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>--compressor</code></td>
      <td><code>str</code></td>
      <td>Compression algorithm to use.</td>
    </tr>
    <tr>
      <td><code>--compressor_params</code></td>
      <td><code>dict</code></td>
      <td>Parameters passed to the compressor.</td>
    </tr>
    <tr>
      <td><code>--output_chunks</code></td>
      <td><code>list</code></td>
      <td>Chunk size configuration for output Zarr arrays.</td>
    </tr>
    <tr>
      <td><code>--overwrite</code></td>
      <td><code>bool</code></td>
      <td>Whether to overwrite existing Zarr data.</td>
    </tr>
    <tr>
      <td><code>--rechunk_method</code></td>
      <td><code>str</code></td>
      <td>Method used for rechunking data (e.g., <code>p2p</code>, <code>rechunker</code>).</td>
    </tr>
    <tr>
      <td><code>--rechunkers_max_mem</code></td>
      <td><code>str</code></td>
      <td>Maximum memory for the <code>rechunker</code> tool.</td>
    </tr>
    <tr>
      <td><code>--trim_memory</code></td>
      <td><code>bool</code></td>
      <td>Whether to reduce memory usage during execution.</td>
    </tr>
    <tr>
      <td><code>--use_tensorstore</code></td>
      <td><code>bool</code></td>
      <td>Use TensorStore as the Zarr backend.</td>
    </tr>
    <tr>
      <td><code>--metadata_reader</code></td>
      <td><code>str</code></td>
      <td>Reader to extract metadata.</td>
    </tr>
    <tr>
      <td><code>--save_omexml</code></td>
      <td><code>bool</code></td>
      <td>Save OME-XML metadata alongside output.</td>
    </tr>
  </tbody>
</table>

<h5 id="downscale-parameters">Downscale parameters</h5>
<table>
  <thead>
    <tr>
      <th style="width: 280px; text-align: left;">Parameter</th>
      <th style="width: 100px;">Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>--downscale_method</code></td>
      <td><code>str</code></td>
      <td>Downscaling algorithm (e.g., <code>simple</code>, <code>mean</code>, etc.).</td>
    </tr>
    <tr>
      <td><code>--n_layers</code></td>
      <td><code>int</code></td>
      <td>Number of downscaling layers to compute.</td>
    </tr>
    <tr>
      <td><code>--scale_factor</code></td>
      <td><code>list</code></td>
      <td>Scaling factors for each dimension.</td>
    </tr>
  </tbody>
</table>

<h5 id="examples_1">Examples</h5>
<p>Convert with 8 workers while limiting the maximum memory per worker:</p>
<pre><code class="language-bash">eubi to_zarr /path/to/input_dir /path/to/output_dir --n_jobs 8 --memory_limit 10GB
</code></pre>
<p>Set a specific output chunk size:</p>
<pre><code class="language-bash">eubi to_zarr /path/to/input_dir /path/to/output_dir --output_chunks 1,1,128,128,128
</code></pre>
<p>Set a specific number of layers, while also specifying the downscaling factors:</p>
<pre><code class="language-bash">eubi to_zarr /path/to/input_dir /path/to/output_dir --n_layers 6 --scale_factor 1,1,2,3,3
</code></pre>
<p><strong>Note: for more examples on <code>to_zarr</code>, refer to the <a href="../conversion_tutorial/#tutorial">tutorial page</a>.</strong></p>
<h2 id="configuration">Configuration</h2>
<p>Many of the parameters of EuBI-Bridge can be configured, i.e., their default values can be updated in the configuration file to avoid repetitively typing them for each conversion.</p>
<h3 id="eubiconfigure_cluster"><code>eubi::configure_cluster</code></h3>
<p>Updates cluster configuration settings. Any of the cluster parameters from the <a href="#cluster-parameters">respective table</a> can be configured. To update the current default value for a parameter, provide that parameter with a value other than <code>'default'</code>.</p>
<h4 id="simple-example"><em>Simple example</em></h4>
<pre><code class="language-bash">eubi configure_cluster --memory_limit 10GB
</code></pre>
<p>This command will set the default memory limit per worker to 10GB. Every time a conversion command is run, each worker will be set to a maximum of 10GB of memory.</p>
<h3 id="eubiconfigure_conversion"><code>eubi::configure_conversion</code></h3>
<p>Updates conversion configuration settings. Any of the cluster parameters from the <a href="#conversion-parameters">respective table</a> can be configured. To update the current default value for a parameter, provide that parameter with a value other than <code>'default'</code>.</p>
<h4 id="simple-example_1"><em>Simple example</em></h4>
<pre><code class="language-bash">eubi configure_conversion --rechunk_method p2p
</code></pre>
<p>This command will set the default rechunk method to p2p.</p>
<hr />
<h3 id="eubiconfigure_downscale"><code>eubi::configure_downscale</code></h3>
<p>Updates downscaling configuration settings. Any of the cluster parameters from the <a href="#downscale-parameters">respective table</a> can be configured. To update the current default value for a parameter, provide that parameter with a value other than <code>'default'</code>.</p>
<h4 id="simple-example_2"><em>Simple example</em></h4>
<pre><code class="language-bash">eubi configure_downscale --scale_factor 1,1,2,2,2
</code></pre>
<p>This will update the default value for the <code>scale_factor</code> to <code>(1,1,2,2,2)</code> in the <code>tczyx</code> order.</p>
<hr />
<h3 id="eubireset_config"><code>eubi::reset_config</code></h3>
<p>Resets the cluster, conversion, and downscale parameters to the installation defaults.</p>
<hr />
<h3 id="eubireset_dask_config"><code>eubi::reset_dask_config</code></h3>
<p>Resets the <code>dask.distributed</code> configuration parameters to the installation defaults.</p>
<hr />
<h3 id="eubishow_config"><code>eubi::show_config</code></h3>
<p>Displays the current cluster, conversion, and downscale parameters.</p>
<hr />
<h3 id="eubishow_dask_config"><code>eubi::show_dask_config</code></h3>
<p>Displays the current <code>dask.distributed</code> parameters.</p>
<hr />
<h3 id="eubishow_root_dask_defaults"><code>eubi::show_root_dask_defaults</code></h3>
<p>Displays the installation defaults for <code>dask.distributed</code>.</p>
<hr />
<h3 id="eubishow_root_defaults"><code>eubi::show_root_defaults</code></h3>
<p>Displays the installation defaults for cluster, conversion, and downscale parameters.</p>
<hr />
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/Euro-BioImaging/EuBI-Bridge" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../js/copy-button.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
